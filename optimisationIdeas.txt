Optimisation ideas:
write to file after every x iterations so save on memory
